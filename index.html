<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù…Ø¯ÛŒØ±ÛŒØª Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø±ÙˆØ²Ø§Ù†Ù‡</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css">
    <style>
        :root { --primary-color: #2c3e50; --accent-color: #27ae60; --dark-bg: #1a1a1a; }
        body { font-family: Tahoma, Geneva, sans-serif; background-color: #f0f2f5; padding: 20px; font-size: 13px; color: #333; }
        .container { max-width: 1250px; margin: auto; background: white; padding: 25px; border-radius: 12px; border: 1px solid #ddd; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        
        .top-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #333; padding-bottom: 15px; }
        .header-item { display: flex; align-items: center; gap: 8px; font-weight: bold; }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø®Ø§Øµ Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„Ø¯ ØªØ§Ø±ÛŒØ® */
        .date-picker-input { 
            background: #f8f9fa; 
            border: 1px solid #cbd5e0 !important; 
            border-radius: 6px !important; 
            padding: 6px 12px !important; 
            width: 150px !important; 
            cursor: pointer;
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
        }

        table { width: 100%; border-collapse: collapse; margin-top: 10px; table-layout: fixed; }
        th { background-color: #333; color: white; padding: 12px; border: 1px solid #444; font-weight: normal; }
        td { border: 1px solid #ddd; padding: 8px; text-align: center; height: 35px; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        
        /* Ø¯Ú©Ù…Ù‡ Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¨Ø§ Ø¸Ø§Ù‡Ø± Ø¬Ø¯ÛŒØ¯ */
        .btn-share { 
            background: linear-gradient(135deg, #2980b9, #3498db);
            margin-top: 20px; 
            width: 100%; 
            padding: 12px;
            font-size: 14px;
            transition: 0.3s;
        }
        .btn-share:hover { opacity: 0.9; transform: translateY(-1px); }

        .summary-report { margin-top: 30px; padding: 20px; border: 1px solid #333; background-color: #fff; width: 260px; border-radius: 10px; }
        .report-field { display: flex; align-items: center; margin-bottom: 12px; }
        .report-field label { font-weight: bold; width: 110px; display: flex; justify-content: space-between; }
        .report-field input { width: 70px; padding: 6px; border: 1px solid #ccc; border-radius: 4px; text-align: center; }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙ‚ÙˆÛŒÙ… Ú©Ù‡ Ø¯ÛŒÚ¯Ø± Ú©Ù„ ØµÙØ­Ù‡ Ø±Ø§ Ù†Ú¯ÛŒØ±Ø¯ */
        .datepicker-plot-area { 
            border-radius: 10px !important; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2) !important;
            border: none !important;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="top-header">
        <div class="header-item">Ø¨Ø±Ù†Ø§Ù…Ù‡ ØªÛŒÙ…ÛŒ: <input type="text" id="ownerName" placeholder="Ù†Ø§Ù… Ù…Ø¯ÛŒØ±"></div>
        <div class="header-item">Ø±ÙˆØ²: <input type="text" id="dayName" readonly style="border:none; width: 80px; color: #777;"></div>
        <div class="header-item">Ù…ÙˆØ±Ø®Ù‡: <input type="text" id="todayDate" class="date-picker-input" readonly></div>
    </div>

    <div class="actions">
        <button class="btn btn-new" style="background-color: var(--accent-color);" onclick="openModal()">+ ÙØ¹Ø§Ù„ÛŒØª Ø¬Ø¯ÛŒØ¯</button>
        <button class="btn btn-clear" style="background-color: #e74c3c;" onclick="clearToday()">Ø­Ø°Ù Ø¯ÛŒØªØ§ÛŒ Ø§Ù…Ø±ÙˆØ²</button>
    </div>

    <table>
        <thead>
            <tr>
                <th style="width: 45px;">Ø±Ø¯ÛŒÙ</th>
                <th style="width: 50px;">Ù†ØªÛŒØ¬Ù‡</th>
                <th>Ø¹Ù†ÙˆØ§Ù† Ø¬Ù„Ø³Ù‡</th>
                <th>Ù…Ø®Ø§Ø·Ø¨</th>
                <th>Ø³Ø§Ø¹Øª</th>
                <th>Ù…Ú©Ø§Ù†</th>
                <th style="width: 60px;">Ø§ØµÙ„Ø§Ø­</th>
                <th style="width: 60px;">Ø­Ø°Ù</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <div class="summary-report">
        <h3>Ú¯Ø²Ø§Ø±Ø´ Ú©Ø§Ø± Ù†Ù‡Ø§ÛŒÛŒ</h3>
        <div class="report-field"><label>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø´Ø§ÙˆØ±<span>:</span></label><input type="number" id="stat_advisor"></div>
        <div class="report-field"><label>Ø²Ù†Ú¯ Ø¯Ø¹ÙˆØª<span>:</span></label><input type="number" id="stat_invite"></div>
        <div class="report-field"><label>Ù¾Ø±Ø²Ù†Øª<span>:</span></label><input type="number" id="stat_present"></div>
        <div class="report-field"><label>Ø§Ø±ØªØ¨Ø§Ø· Ù…Ø¤Ø«Ø±<span>:</span></label><input type="number" id="stat_relation"></div>
        <div class="report-field"><label>Ø¢Ù…ÙˆØ²Ø´<span>:</span></label><input type="number" id="stat_edu"></div>
        <div class="report-field"><label>Ø«Ø¨Øª Ù†Ø§Ù…<span>:</span></label><input type="number" id="stat_reg"></div>
        <div class="report-field"><label>Ø§Ù…ØªÛŒØ§Ø² Ø®Ø±ÛŒØ¯<span>:</span></label><input type="number" id="stat_point"></div>
        
        <button class="btn btn-share" onclick="shareReport()">ğŸ“¤ Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¯Ø± Ù¾ÛŒØ§Ù…â€ŒØ±Ø³Ø§Ù†</button>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://unpkg.com/persian-date@1.1.0/dist/persian-date.min.js"></script>
<script src="https://unpkg.com/persian-datepicker@1.2.0/dist/js/persian-datepicker.min.js"></script>

<script>
    let currentKey = "";

    $(document).ready(function() {
        // ØªÙ†Ø¸ÛŒÙ… ØªÙ‚ÙˆÛŒÙ… Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„ Ù…Ø¯Ø±Ù†â€ŒØªØ± Ùˆ Ø¬Ù…Ø¹â€ŒÙˆØ¬ÙˆØ±
        $("#todayDate").persianDatepicker({
            format: 'YYYY/MM/DD',
            autoClose: true,
            observer: true,
            position: [0, 0], // Ø¨Ø§Ø² Ø´Ø¯Ù† Ø¯Ù‚ÛŒÙ‚ Ø²ÛŒØ± ÙÛŒÙ„Ø¯
            onSelect: function(unix) {
                const pDate = new persianDate(unix);
                currentKey = pDate.format('YYYY/MM/DD');
                document.getElementById('dayName').value = pDate.format('dddd');
                loadDateData(currentKey);
            }
        });

        // Ù„ÙˆØ¯ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ø§Ù…Ø±ÙˆØ²
        const now = new persianDate();
        currentKey = now.format('YYYY/MM/DD');
        $("#todayDate").val(currentKey);
        $("#dayName").val(now.format('dddd'));
        loadDateData(currentKey);

        // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… ØªØºÛŒÛŒØ± Ù‡Ø± ÙÛŒÙ„Ø¯
        $(document).on('input', 'input', function() { saveDateData(); });
    });

    function loadDateData(key) {
        const data = JSON.parse(localStorage.getItem('data_' + key)) || { plans: [], stats: {}, owner: localStorage.getItem('globalOwner') || "" };
        document.getElementById('ownerName').value = data.owner;
        // Ù¾Ø± Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§ Ùˆ Ø¬Ø¯ÙˆÙ„ (Ù…Ø´Ø§Ø¨Ù‡ Ú©Ø¯Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± Ø¬Ø¯ÛŒØ¯)
        // ... (ØªÙˆØ§Ø¨Ø¹ Render Ùˆ Save Ø¯Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ù†Ø¯)
    }

    function shareReport() {
        // Ù‡Ù…Ø§Ù† Ù‚Ø§Ù„Ø¨ Ù…ØªÙ†ÛŒ Ú©Ù‡ Ø®ÙˆØ§Ø³ØªÙ‡ Ø¨ÙˆØ¯ÛŒØ¯
        const day = $("#dayName").val();
        const date = currentKey;
        const text = `Ø³Ù„Ø§Ù… Ùˆ Ø®Ø¯Ø§ Ù‚ÙˆØª ğŸŒº\n\nÚ¯Ø²Ø§Ø±Ø´ Ú©Ø§Ø±\n\n${day} ${date}\n...`; 
        // Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‡Ø§ÛŒÛŒ Ù…ØªÙ†
        if (navigator.share) navigator.share({ text: text });
    }
</script>
</body>
</html>
